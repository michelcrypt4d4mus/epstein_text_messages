from epstein_files.documents.doj_file import DojFile
from epstein_files.epstein_files import count_by_month
from epstein_files.util.rich import console


EXPECTED_MONTHLY_COUNTS = {
    "1985-01": 1,
    "2000-01": 1,
    "2000-03": 1,
    "2000-04": 4,
    "2000-06": 1,
    "2000-11": 2,
    "2000-12": 1,
    "2001-01": 6,
    "2001-02": 3,
    "2001-04": 4,
    "2001-06": 1,
    "2001-07": 1,
    "2001-08": 1,
    "2001-10": 1,
    "2001-11": 1,
    "2002-01": 3,
    "2002-03": 1,
    "2002-10": 1,
    "2003-02": 3,
    "2003-04": 2,
    "2003-07": 1,
    "2003-09": 2,
    "2004-01": 5,
    "2004-02": 3,
    "2004-04": 2,
    "2004-05": 2,
    "2004-07": 3,
    "2005-01": 2,
    "2005-02": 2,
    "2005-03": 1,
    "2005-04": 3,
    "2005-05": 2,
    "2005-06": 2,
    "2005-07": 1,
    "2005-09": 2,
    "2005-10": 1,
    "2005-11": 1,
    "2006-01": 2,
    "2006-03": 1,
    "2006-07": 3,
    "2006-08": 1,
    "2006-09": 1,
    "2006-10": 1,
    "2007-01": 2,
    "2007-02": 1,
    "2007-03": 2,
    "2007-04": 3,
    "2007-05": 3,
    "2007-06": 2,
    "2007-07": 2,
    "2007-08": 1,
    "2007-09": 3,
    "2007-10": 1,
    "2008-01": 2,
    "2008-02": 4,
    "2008-04": 2,
    "2008-05": 8,
    "2008-06": 5,
    "2008-07": 5,
    "2008-08": 1,
    "2008-09": 2,
    "2008-10": 1,
    "2008-11": 2,
    "2009-01": 1,
    "2009-02": 5,
    "2009-04": 2,
    "2009-05": 4,
    "2009-06": 5,
    "2009-07": 4,
    "2009-08": 11,
    "2009-09": 3,
    "2009-10": 10,
    "2009-11": 1,
    "2009-12": 4,
    "2010-01": 23,
    "2010-02": 10,
    "2010-03": 2,
    "2010-05": 1,
    "2010-06": 2,
    "2010-07": 5,
    "2010-08": 1,
    "2010-09": 1,
    "2010-10": 5,
    "2010-11": 9,
    "2010-12": 12,
    "2011-01": 14,
    "2011-02": 15,
    "2011-03": 63,
    "2011-04": 38,
    "2011-05": 16,
    "2011-06": 21,
    "2011-07": 16,
    "2011-08": 18,
    "2011-09": 4,
    "2011-10": 5,
    "2011-11": 8,
    "2011-12": 4,
    "2012-01": 10,
    "2012-02": 6,
    "2012-03": 7,
    "2012-04": 5,
    "2012-05": 12,
    "2012-06": 6,
    "2012-07": 8,
    "2012-08": 13,
    "2012-09": 8,
    "2012-10": 5,
    "2012-11": 11,
    "2013-01": 12,
    "2013-02": 18,
    "2013-03": 11,
    "2013-04": 5,
    "2013-05": 10,
    "2013-06": 2,
    "2013-07": 8,
    "2013-08": 6,
    "2013-09": 9,
    "2013-10": 18,
    "2013-11": 4,
    "2013-12": 8,
    "2014-01": 19,
    "2014-02": 12,
    "2014-03": 9,
    "2014-04": 12,
    "2014-05": 2,
    "2014-06": 6,
    "2014-07": 10,
    "2014-08": 2,
    "2014-09": 31,
    "2014-10": 12,
    "2014-11": 2,
    "2014-12": 8,
    "2015-01": 73,
    "2015-02": 6,
    "2015-03": 19,
    "2015-04": 18,
    "2015-05": 6,
    "2015-06": 3,
    "2015-07": 8,
    "2015-08": 17,
    "2015-09": 16,
    "2015-10": 11,
    "2015-11": 4,
    "2015-12": 35,
    "2016-01": 19,
    "2016-02": 32,
    "2016-03": 21,
    "2016-04": 25,
    "2016-05": 36,
    "2016-06": 35,
    "2016-07": 40,
    "2016-08": 25,
    "2016-09": 43,
    "2016-10": 85,
    "2016-11": 154,
    "2016-12": 53,
    "2017-01": 71,
    "2017-02": 79,
    "2017-03": 41,
    "2017-04": 38,
    "2017-05": 75,
    "2017-06": 33,
    "2017-07": 34,
    "2017-08": 21,
    "2017-09": 68,
    "2017-10": 20,
    "2017-11": 44,
    "2017-12": 49,
    "2018-01": 84,
    "2018-02": 38,
    "2018-03": 69,
    "2018-04": 41,
    "2018-05": 24,
    "2018-06": 33,
    "2018-07": 56,
    "2018-08": 55,
    "2018-09": 41,
    "2018-10": 32,
    "2018-11": 39,
    "2018-12": 69,
    "2019-01": 17,
    "2019-02": 73,
    "2019-03": 51,
    "2019-04": 29,
    "2019-05": 66,
    "2019-06": 48,
    "2019-07": 25,
    "2019-08": 7,
    "2019-09": 7,
    "2019-10": 2,
    "2019-11": 1,
    "2019-12": 3,
    "2020-01": 1,
    "2020-02": 8,
    "2020-03": 2,
    "2020-04": 2,
    "2020-06": 2,
    "2020-07": 38,
    "2020-08": 1,
    "2020-10": 1,
    "2020-11": 6,
    "2020-12": 1,
    "2021-01": 2,
    "2021-02": 1,
    "2021-03": 1,
    "2021-04": 14,
    "2021-05": 11,
    "2021-06": 2,
    "2021-07": 2,
    "2021-08": 9,
    "2021-09": 1,
    "2021-10": 2,
    "2021-11": 17,
    "2021-12": 3,
    "2022-01": 3,
    "2022-02": 5,
    "2022-05": 2,
    "2022-06": 1,
    "2023-02": 2,
    "2023-05": 4,
    "2023-06": 13,
    "2023-07": 15,
    "2023-08": 1,
    "2023-12": 2,
    "2024-01": 1,
    "2024-02": 4,
    "2024-03": 15,
    "2024-05": 3,
    "2024-07": 2,
    "2024-08": 1,
    "2024-10": 2,
    "2024-11": 2,
    "2024-12": 1,
    None: 2155
}


def test_document_monthly_counts(epstein_files):
    # for doc in epstein_files.all_documents():
    #     if doc.timestamp and str(doc.timestamp) > '2020-01-01':
    #         console.print(doc)

    assert count_by_month(epstein_files.all_documents()) == EXPECTED_MONTHLY_COUNTS
